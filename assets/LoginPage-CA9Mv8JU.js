import{u as F,j as e,a as C,B as o,b as a,P as U,f as j,g as B,S,h as T,I as y,i as W,k as M,V,l as z,L as H,A as R,d as K,m as _,D as q}from"./mui-erjdo8JM.js";import{r as s}from"./vendor-BPyidg2q.js";import{S as G}from"./SystemHeader-6NC7BAwB.js";import{u as Y,a as h,s as J,b as Q,c as X,d as Z,e as D,l as ee}from"./index-t1T6yRgK.js";import{u as re,a as se}from"./router-Cq5RlOku.js";import"./redux-B6kvt0Aa.js";function de(){const i=F(),m=re(),I=se(),c=Y(),l=h(J),u=h(Q),p=h(X),x=h(Z),[t,N]=s.useState({userId:"",password:""}),[g,k]=s.useState(!1),[n,E]=s.useState({}),f=s.useRef(!1);s.useEffect(()=>{if(p&&x&&!f.current){console.log("üîÑ User already authenticated, redirecting...",{role:x.role}),f.current=!0;const r=I.state?.from?.pathname;setTimeout(()=>{r&&r!=="/login"?m(r,{replace:!0}):x.role==="admin"?m("/menu/admin",{replace:!0}):m("/menu/main",{replace:!0})},100)}},[p,x,m,I.state]),s.useEffect(()=>{p||(f.current=!1)},[p]);const w=s.useCallback(()=>{const r={};return t.userId.trim()?t.userId.length>8&&(r.userId="El ID de usuario debe tener 8 caracteres o menos"):r.userId="Por favor ingrese su ID de usuario...",t.password.trim()?t.password.length>8&&(r.password="La contrase√±a debe tener 8 caracteres o menos"):r.password="Por favor ingrese su contrase√±a...",E(r),Object.keys(r).length===0},[t]),A=s.useCallback(r=>d=>{const v=d.target.value;v.length<=8&&(N(b=>({...b,[r]:v.toUpperCase()})),n[r]&&E(b=>({...b,[r]:""})),u&&c(D()))},[n,u,c]),L=s.useCallback(async r=>{if(r.preventDefault(),!!w())try{console.log("üîê Attempting login with:",{userId:t.userId});const d=await c(ee(t)).unwrap();console.log("‚úÖ Login successful, result:",d)}catch(d){console.error("‚ùå Login failed:",d)}},[t,w,c]),O=s.useCallback(r=>{(r.key==="F3"||r.key==="Escape")&&(r.preventDefault(),window.confirm("¬øEst√° seguro que desea salir del sistema?")&&window.close())},[]),P=s.useCallback(()=>{c(D())},[c]),$=r=>({"Invalid credentials":"Contrase√±a incorrecta. Intente de nuevo...","User not found":"Usuario no encontrado. Intente de nuevo...","Please check your input":"Verifique su ID de usuario y contrase√±a","Network error occurred":"No se pudo verificar el usuario. Revise su conexi√≥n."})[r]||r;return p&&x?e.jsx(C,{maxWidth:"md",sx:{py:4},children:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(a,{variant:"h5",gutterBottom:!0,children:"Redirigiendo..."}),e.jsx(a,{variant:"body1",color:"text.secondary",children:"Ya ha iniciado sesi√≥n. Lo redirigiremos a su panel."})]})}):e.jsx(C,{maxWidth:"md",sx:{py:4},children:e.jsxs(o,{onKeyDown:O,tabIndex:-1,children:[e.jsx(G,{transactionId:"CC00",programName:"COSGN00C",title:"CardDemo - Aplicaci√≥n de demostraci√≥n de tarjetas",subtitle:"Modernizaci√≥n de mainframe",showNavigation:!1}),e.jsxs(U,{elevation:3,sx:{borderRadius:3,overflow:"hidden",background:`linear-gradient(145deg, ${j(i.palette.background.paper,.9)}, ${j(i.palette.background.default,.1)})`},children:[e.jsxs(o,{sx:{p:4,textAlign:"center",background:`linear-gradient(135deg, ${i.palette.primary.main}, ${i.palette.secondary.main})`,color:"white"},children:[e.jsx(B,{sx:{fontSize:48,mb:2}}),e.jsx(a,{variant:"h4",fontWeight:600,gutterBottom:!0,children:"NATIONAL RESERVE NOTE"}),e.jsx(a,{variant:"h6",sx:{opacity:.9},children:"THE UNITED STATES OF KICSLAND"}),e.jsx(o,{sx:{mt:2,p:2,border:"2px solid rgba(255,255,255,0.3)",borderRadius:2,fontFamily:"monospace",fontSize:"0.75rem",lineHeight:1.2,whiteSpace:"pre",textAlign:"center",overflow:"auto",backgroundColor:"rgba(0,0,0,0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:`+========================================+
|%%%%%%%  NATIONAL RESERVE NOTE  %%%%%%%%|
|%(1)  THE UNITED STATES OF KICSLAND (1)%|
|%$$              ___       ********  $$%|
|%$    {x}       (o o)                 $%|
|%$     ******  (  V  )      O N E     $%|
|%(1)          ---m-m---             (1)%|
|%%~~~~~~~~~~~ ONE DOLLAR ~~~~~~~~~~~~~%%|
+========================================+`})]}),e.jsxs(o,{sx:{p:4},children:[e.jsx(a,{variant:"h6",color:"primary.main",textAlign:"center",gutterBottom:!0,sx:{mb:3},children:"Ingrese su ID de usuario y contrase√±a, luego presione ENTER:"}),e.jsx(o,{component:"form",onSubmit:L,sx:{maxWidth:400,mx:"auto"},children:e.jsxs(S,{spacing:3,children:[e.jsx(T,{label:"ID de Usuario",value:t.userId,onChange:A("userId"),error:!!n.userId,helperText:n.userId||"(8 caracteres)",disabled:l,autoFocus:!0,inputProps:{maxLength:8,style:{textTransform:"uppercase"}},InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(W,{color:"primary"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(T,{label:"Contrase√±a",type:g?"text":"password",value:t.password,onChange:A("password"),error:!!n.password,helperText:n.password||"(8 caracteres)",disabled:l,autoComplete:"current-password",inputProps:{maxLength:8,style:{textTransform:"uppercase"}},InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(H,{color:"primary"})}),endAdornment:e.jsx(y,{position:"end",children:e.jsx(M,{onClick:()=>k(!g),edge:"end",disabled:l,children:g?e.jsx(V,{}):e.jsx(z,{})})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),(u||Object.keys(n).length>0)&&e.jsx(e.Fragment,{children:u?e.jsx(R,{severity:"error",onClose:P,sx:{borderRadius:2},children:$(u)}):e.jsx(R,{severity:"error",sx:{borderRadius:2},children:"Corrija los errores anteriores"})}),e.jsx(K,{type:"submit",variant:"contained",size:"large",disabled:l,startIcon:e.jsx(_,{}),sx:{py:1.5,borderRadius:2,fontWeight:600,fontSize:"1rem"},children:l?"Iniciando sesi√≥n...":"ENTER = Iniciar sesi√≥n"})]})}),e.jsx(q,{sx:{my:3}}),e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(a,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Credenciales de prueba:"}),e.jsxs(S,{direction:"row",spacing:2,justifyContent:"center",flexWrap:"wrap",children:[e.jsx(a,{variant:"caption",sx:{bgcolor:"warning.main",color:"warning.contrastText",px:1,py:.5,borderRadius:1},children:"Admin: ADMIN001 / PASSWORD"}),e.jsx(a,{variant:"caption",sx:{bgcolor:"success.main",color:"success.contrastText",px:1,py:.5,borderRadius:1},children:"Back-Office: USER001 / PASSWORD"})]})]})]}),e.jsx(o,{sx:{p:2,bgcolor:j(i.palette.grey[100],.5),borderTop:`1px solid ${i.palette.divider}`,textAlign:"center"},children:e.jsx(a,{variant:"body2",color:"text.secondary",children:"ENTER = Iniciar sesi√≥n ‚Ä¢ F3 = Salir"})})]})]})})}export{de as default};
