import{u as z,j as e,a as L,B as i,P as K,f as j,b as o,a2 as M,h as T,d as I,z as H,D as Q,S as W,t as V,n as q,i as G,A as J,K as X,aQ as A,ac as Y,x as Z,a7 as _,a8 as ee,aa as re,ab as te}from"./mui-erjdo8JM.js";import{r as a}from"./vendor-BPyidg2q.js";import{S as se}from"./SystemHeader-D3dJsKY0.js";import{u as ne,d as ae}from"./router-Cq5RlOku.js";import{u as E}from"./useApi-Cjv0eN4P.js";import{L as le}from"./index-9pJum61k.js";import{U as O}from"./userApi-wD6oQdhM.js";import"./redux-B6kvt0Aa.js";function ie({formData:x,errors:y,loading:d,message:p,messageType:c,userData:s,onFormChange:f,onFetchUser:h,onDelete:C,onClear:l,onExit:b}){const r=z(),[g,m]=a.useState(!1),U=a.useCallback(n=>{n.key==="F3"||n.key==="Escape"?(n.preventDefault(),b()):n.key==="F4"?(n.preventDefault(),l()):n.key==="F5"?(n.preventDefault(),s&&m(!0)):n.key==="F12"&&(n.preventDefault(),b())},[b,l,s]),k=a.useCallback(n=>{n.preventDefault(),h()},[h]),v=a.useCallback(()=>{m(!1),C()},[C]),w=s!==null,S=n=>n==="A"?"Admin":"User";return e.jsx(L,{maxWidth:"lg",sx:{py:3},children:e.jsxs(i,{onKeyDown:U,tabIndex:-1,children:[e.jsx(se,{transactionId:"CU03",programName:"COUSR03C",title:"Delete User",subtitle:"User Security Management"}),e.jsxs(K,{elevation:2,sx:{borderRadius:3,overflow:"hidden",background:`linear-gradient(145deg, ${j(r.palette.background.paper,.9)}, ${j(r.palette.background.default,.1)})`},children:[e.jsx(i,{sx:{p:3,background:`linear-gradient(135deg, ${r.palette.error.main}, ${r.palette.error.dark})`,color:"white"},children:e.jsxs(o,{variant:"h5",fontWeight:600,gutterBottom:!0,children:[e.jsx(M,{sx:{mr:1,verticalAlign:"middle"}}),"Delete User Information"]})}),e.jsx(i,{sx:{p:3,bgcolor:j(r.palette.info.main,.05)},children:e.jsxs(i,{component:"form",onSubmit:k,sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(o,{variant:"body1",fontWeight:600,color:"primary.main",children:"Enter User ID:"}),e.jsx(T,{value:x.userId,onChange:n=>f("userId",n.target.value.toUpperCase()),placeholder:"USER001",size:"small",disabled:d,error:!!y.userId,helperText:y.userId,inputProps:{maxLength:8,style:{textAlign:"center",fontSize:"1rem",fontWeight:600}},sx:{width:150,"& .MuiOutlinedInput-root":{bgcolor:"white","&:hover":{"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main,borderWidth:2}}}}}),e.jsx(I,{type:"submit",variant:"contained",disabled:d||!x.userId.trim(),startIcon:e.jsx(H,{}),sx:{fontWeight:600},children:"Fetch User"})]})}),e.jsx(Q,{}),e.jsx(i,{sx:{px:3,py:1,bgcolor:j(r.palette.warning.main,.1),borderTop:`3px solid ${r.palette.warning.main}`,borderBottom:`3px solid ${r.palette.warning.main}`},children:e.jsx(o,{variant:"body2",color:"warning.dark",fontWeight:600,textAlign:"center",children:"*".repeat(70)})}),e.jsx(i,{sx:{p:3},children:e.jsxs(W,{spacing:3,children:[e.jsxs(i,{children:[e.jsx(o,{variant:"body1",fontWeight:600,color:"info.main",gutterBottom:!0,children:"First Name:"}),e.jsx(T,{value:s?.firstName||"",disabled:!0,fullWidth:!0,variant:"outlined",sx:{"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:r.palette.primary.main,fontWeight:600},"& .MuiOutlinedInput-root.Mui-disabled":{bgcolor:j(r.palette.primary.main,.05),"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main}}}})]}),e.jsxs(i,{children:[e.jsx(o,{variant:"body1",fontWeight:600,color:"info.main",gutterBottom:!0,children:"Last Name:"}),e.jsx(T,{value:s?.lastName||"",disabled:!0,fullWidth:!0,variant:"outlined",sx:{"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:r.palette.primary.main,fontWeight:600},"& .MuiOutlinedInput-root.Mui-disabled":{bgcolor:j(r.palette.primary.main,.05),"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main}}}})]}),e.jsxs(i,{children:[e.jsx(o,{variant:"body1",fontWeight:600,color:"info.main",gutterBottom:!0,children:"User Type:"}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(T,{value:s?.userType||"",disabled:!0,sx:{width:80,"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:r.palette.primary.main,fontWeight:600,textAlign:"center"},"& .MuiOutlinedInput-root.Mui-disabled":{bgcolor:j(r.palette.primary.main,.05),"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main}}}}),s&&e.jsx(V,{label:S(s.userType),size:"small",color:s.userType==="A"?"error":"primary",icon:s.userType==="A"?e.jsx(q,{}):e.jsx(G,{}),variant:"outlined"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"(A=Admin, U=User)"})]})]})]})}),p&&e.jsx(i,{sx:{px:3,pb:2},children:e.jsx(J,{severity:c||"info",sx:{borderRadius:2},children:p})}),e.jsx(i,{sx:{p:3,bgcolor:j(r.palette.grey[100],.5),borderTop:`1px solid ${r.palette.divider}`},children:e.jsxs(W,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,children:[e.jsxs(W,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(I,{variant:"contained",startIcon:e.jsx(X,{}),onClick:h,disabled:d||!x.userId.trim(),size:"small",children:"ENTER = Fetch"}),e.jsx(I,{variant:"contained",startIcon:e.jsx(A,{}),onClick:()=>m(!0),disabled:d||!w,color:"error",size:"small",children:"F5 = Delete"})]}),e.jsxs(W,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(I,{variant:"outlined",startIcon:e.jsx(Y,{}),onClick:l,disabled:d,size:"small",children:"F4 = Clear"}),e.jsx(I,{variant:"outlined",startIcon:e.jsx(Z,{}),onClick:b,disabled:d,size:"small",children:"F3 = Back"})]})]})})]}),e.jsxs(_,{open:g,onClose:()=>m(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ee,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(M,{color:"error"}),"Confirm User Deletion"]}),e.jsxs(re,{children:[e.jsx(o,{variant:"body1",gutterBottom:!0,children:"Are you sure you want to delete the following user?"}),s&&e.jsxs(i,{sx:{mt:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsxs(o,{variant:"body2",children:[e.jsx("strong",{children:"User ID:"})," ",s.userId]}),e.jsxs(o,{variant:"body2",children:[e.jsx("strong",{children:"Name:"})," ",s.firstName," ",s.lastName]}),e.jsxs(o,{variant:"body2",children:[e.jsx("strong",{children:"Type:"})," ",S(s.userType)]})]}),e.jsxs(o,{variant:"body2",color:"error",sx:{mt:2},children:[e.jsx("strong",{children:"Warning:"})," This action cannot be undone."]})]}),e.jsxs(te,{children:[e.jsx(I,{onClick:()=>m(!1),variant:"outlined",children:"Cancel"}),e.jsx(I,{onClick:v,variant:"contained",color:"error",startIcon:e.jsx(A,{}),children:"Delete User"})]})]})]})})}function oe(x={}){const y=ne(),[d]=ae(),p=d.get("userId")||"",[c,s]=a.useState({userId:p}),[f,h]=a.useState({}),[C,l]=a.useState(null),[b,r]=a.useState(null),[g,m]=a.useState(null),U=!1,{mutate:k,loading:v}=E(async t=>{if(console.log("ðŸ” Fetching user for deletion:",{userId:t,useMocks:U}),!U){const u=await O.getUserById(t);return u.success&&u.data?{success:!0,data:u.data}:{success:!1,error:u.error||"User not found"}}},{onSuccess:t=>{console.log("âœ… User fetched for deletion:",t),m(t),l("Press F5 key to delete this user ..."),r("info"),h({})},onError:t=>{console.error("âŒ Error fetching user for deletion:",t),m(null),l(t),r("error"),x.onError?.(t)}}),{mutate:w,loading:S}=E(async t=>{if(console.log("ðŸ—‘ï¸ Deleting user:",{userId:t,useMocks:U}),!U){const u=await O.deleteUser(t);return u.success&&u.data?{success:!0,data:u.data}:{success:!1,error:u.data?.message||"Delete failed"}}},{onSuccess:t=>{console.log("âœ… User deleted successfully:",t),l(t.message||`User ${c.userId} has been deleted ...`),r("success"),m(null),s({userId:""}),x.onSuccess?.(t.message||`User ${c.userId} has been deleted ...`)},onError:t=>{console.error("âŒ Error deleting user:",t),l(t),r("error"),x.onError?.(t)}}),n=a.useCallback(()=>{const t={};return c.userId.trim()||(t.userId="User ID can NOT be empty..."),h(t),Object.keys(t).length===0},[c]),B=a.useCallback((t,u)=>{s(D=>({...D,[t]:u})),f[t]&&h(D=>{const F={...D};return delete F[t],F})},[f]),N=a.useCallback(()=>{if(!n()){l("User ID can NOT be empty..."),r("error");return}k(c.userId.trim())},[c.userId,k,n]),P=a.useCallback(()=>{if(!g){l("No user selected for deletion..."),r("error");return}w(g.userId)},[g,w]),R=a.useCallback(()=>{s({userId:""}),m(null),h({}),l(null),r(null)},[]),$=a.useCallback(()=>{y("/admin/users/list")},[y]);return a.useEffect(()=>{p&&!g&&!v&&(console.log("ðŸš€ Auto-fetching user for deletion from URL params:",p),k(p))},[p,g,v,k]),{formData:c,errors:f,loading:v||S,message:C,messageType:b,userData:g,handleFormChange:B,handleFetchUser:N,handleDelete:P,handleClear:R,handleExit:$,canDelete:g!==null,isValid:Object.keys(f).length===0}}function be(){const{formData:x,errors:y,loading:d,message:p,messageType:c,userData:s,handleFormChange:f,handleFetchUser:h,handleDelete:C,handleClear:l,handleExit:b}=oe({onError:r=>{console.error("User delete error:",r)},onSuccess:r=>{console.log("User delete success:",r)}});return d&&!s?e.jsx(le,{}):e.jsx(ie,{formData:x,errors:y,loading:d,message:p,messageType:c,userData:s,onFormChange:f,onFetchUser:h,onDelete:C,onClear:l,onExit:b})}export{be as default};
